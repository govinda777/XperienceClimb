# ðŸš€ XperienceClimb - Environment Variables (Updated for Multi-Payment System)

## ðŸ“‹ Required Environment Variables

### Core Application
NEXT_PUBLIC_APP_URL=http://localhost:3000
NODE_ENV=development

### Mercado Pago (Existing + PIX Support)
MERCADOPAGO_ACCESS_TOKEN=your_mercadopago_access_token
NEXT_PUBLIC_MERCADOPAGO_PUBLIC_KEY=your_mercadopago_public_key
MERCADOPAGO_PIX_ENABLED=true

### Success/Failure URLs
NEXT_PUBLIC_SUCCESS_URL=http://localhost:3000/checkout/success
NEXT_PUBLIC_FAILURE_URL=http://localhost:3000/checkout/failure
NEXT_PUBLIC_PENDING_URL=http://localhost:3000/checkout/pending

### Privy Authentication (Existing)
NEXT_PUBLIC_PRIVY_APP_ID=your_privy_app_id
PRIVY_APP_SECRET=your_privy_app_secret

### Crypto Payments (NEW)
NEXT_PUBLIC_BITCOIN_NETWORK=testnet
NEXT_PUBLIC_ETHEREUM_NETWORK=sepolia
NEXT_PUBLIC_USDT_CONTRACT_ADDRESS=0x...
CRYPTO_WALLET_PRIVATE_KEY=your_private_key_for_receiving_payments
CRYPTO_EXCHANGE_RATE_API_KEY=your_coingecko_api_key

### Coupon System (NEW)
COUPON_SECRET_KEY=your_secret_key_for_coupon_validation
NEXT_PUBLIC_COUPON_ENABLED=true
COUPON_ENCRYPTION_KEY=your_32_character_encryption_key

### Webhook Security (NEW)
WEBHOOK_SECRET_MERCADOPAGO=your_mercadopago_webhook_secret
WEBHOOK_SECRET_CRYPTO=your_crypto_webhook_secret

### Database (if using external DB)
DATABASE_URL=your_database_connection_string
REDIS_URL=your_redis_url_for_caching

### Monitoring & Analytics (Optional)
SENTRY_DSN=your_sentry_dsn
GOOGLE_ANALYTICS_ID=your_ga_id

## ðŸ”§ Development vs Production

### Development (.env.local)
```env
NEXT_PUBLIC_APP_URL=http://localhost:3000
MERCADOPAGO_ACCESS_TOKEN=TEST-your_test_token
NEXT_PUBLIC_MERCADOPAGO_PUBLIC_KEY=TEST-your_test_public_key
NEXT_PUBLIC_BITCOIN_NETWORK=testnet
NEXT_PUBLIC_ETHEREUM_NETWORK=sepolia
COUPON_SECRET_KEY=dev_secret_key_32_characters_long
NODE_ENV=development
```

### Production (.env.production)
```env
NEXT_PUBLIC_APP_URL=https://your-domain.com
MERCADOPAGO_ACCESS_TOKEN=your_production_token
NEXT_PUBLIC_MERCADOPAGO_PUBLIC_KEY=your_production_public_key
NEXT_PUBLIC_BITCOIN_NETWORK=mainnet
NEXT_PUBLIC_ETHEREUM_NETWORK=mainnet
COUPON_SECRET_KEY=your_secure_production_key
NODE_ENV=production
```

## ðŸ” Security Notes

### Critical Security Variables (Never expose to client)
- MERCADOPAGO_ACCESS_TOKEN
- PRIVY_APP_SECRET
- CRYPTO_WALLET_PRIVATE_KEY
- COUPON_SECRET_KEY
- WEBHOOK_SECRET_*
- DATABASE_URL

### Client-Safe Variables (NEXT_PUBLIC_ prefix)
- NEXT_PUBLIC_APP_URL
- NEXT_PUBLIC_MERCADOPAGO_PUBLIC_KEY
- NEXT_PUBLIC_PRIVY_APP_ID
- NEXT_PUBLIC_BITCOIN_NETWORK
- NEXT_PUBLIC_ETHEREUM_NETWORK
- NEXT_PUBLIC_COUPON_ENABLED

## ðŸ“ Setup Instructions

### 1. Mercado Pago Setup
1. Create account at https://mercadopago.com.br
2. Go to Developers > Your integrations
3. Create new application
4. Copy Access Token and Public Key
5. Configure webhook URL: https://your-domain.com/api/mercadopago/webhook

### 2. Privy Setup (Existing)
1. Go to https://privy.io
2. Create new app
3. Copy App ID and App Secret
4. Configure allowed domains

### 3. Crypto Setup (NEW)
1. Choose blockchain monitoring service (Alchemy, Infura, etc.)
2. Create wallet for receiving payments
3. Set up webhook endpoints for transaction monitoring
4. Configure exchange rate API (CoinGecko, CoinMarketCap)

### 4. Coupon System Setup (NEW)
1. Generate secure secret key (32+ characters)
2. Set up encryption key for sensitive coupon data
3. Configure coupon validation rules

## ðŸ§ª Testing Configuration

### Test Coupons (Automatically Created)
- WELCOME10: 10% discount, all payment methods
- CLIMB50: R$ 50 fixed discount, credit card and PIX only
- CRYPTO15: 15% discount, crypto payments only

### Test Payment Methods
- Credit Card: Use Mercado Pago test cards
- PIX: Use Mercado Pago sandbox
- Bitcoin: Use testnet addresses
- USDT: Use Sepolia testnet

## ðŸš¨ Important Notes

1. **Never commit .env files to version control**
2. **Use different keys for development and production**
3. **Regularly rotate webhook secrets**
4. **Monitor failed webhook deliveries**
5. **Set up proper logging for payment failures**
6. **Test all payment methods in sandbox/testnet first**

## ðŸ“Š Monitoring Variables (Optional)

```env
# Error Tracking
SENTRY_DSN=your_sentry_dsn
SENTRY_ENVIRONMENT=production

# Analytics
GOOGLE_ANALYTICS_ID=GA-XXXXXXXXX
MIXPANEL_TOKEN=your_mixpanel_token

# Performance Monitoring
NEW_RELIC_LICENSE_KEY=your_newrelic_key
DATADOG_API_KEY=your_datadog_key
```

## ðŸ”„ Migration from Old System

If migrating from the old WhatsApp-only system:

1. Keep existing variables for backward compatibility
2. Add new payment method variables gradually
3. Test each payment method individually
4. Update webhook endpoints
5. Monitor payment success rates

## ðŸ“ž Support

For environment setup issues:
- Check Mercado Pago documentation
- Verify webhook URLs are accessible
- Test API keys in sandbox first
- Monitor application logs for errors


> xperience-climb@0.1.0 test
> jest

FAIL src/__tests__/integration/payment-flow.test.ts
  ● Console

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:134:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:134:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:167:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:167:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:224:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:224:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:291:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:291:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:319:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:319:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:359:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:359:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:379:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:379:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:400:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:400:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:451:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:451:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:496:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:496:47)

    console.error
      Error creating order: Error: User ID is required
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:248:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:524:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:524:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:549:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:549:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:572:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:572:47)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:602:48)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:602:48)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:606:48)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:606:48)

    console.error
      Error creating order: Error: Climbing date must be in the future
          at CreateOrder.validateRequest (/app/src/core/use-cases/orders/CreateOrder.ts:261:13)
          at CreateOrder.validateRequest [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:45:12)
          at Object.execute (/app/src/__tests__/integration/payment-flow.test.ts:626:47)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at Object.execute (src/__tests__/integration/payment-flow.test.ts:626:47)

  ● Payment Flow Integration Tests › PIX Payment Flow › should complete PIX payment flow successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      135 |
      136 |       // Assert
    > 137 |       expect(result.success).toBe(true);
          |                              ^
      138 |       expect(result.orderId).toBeDefined();
      139 |       expect(result.pixPayment).toEqual(pixPaymentResponse);
      140 |       expect(mockOrderRepository.create).toHaveBeenCalledWith(

      at Object.toBe (src/__tests__/integration/payment-flow.test.ts:137:30)

  ● Payment Flow Integration Tests › PIX Payment Flow › should handle PIX payment timeout

    expect(received).toContain(expected) // indexOf

    Expected substring: "PIX payment"
    Received string:    "Climbing date must be in the future"

      169 |       // Assert
      170 |       expect(result.success).toBe(false);
    > 171 |       expect(result.error).toContain('PIX payment');
          |                            ^
      172 |     });
      173 |
      174 |     it('should process PIX webhook correctly', async () => {

      at Object.toContain (src/__tests__/integration/payment-flow.test.ts:171:28)

  ● Payment Flow Integration Tests › PIX Payment Flow › should process PIX webhook correctly

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "pix-123"

    Number of calls: 0

      195 |
      196 |       // Assert
    > 197 |       expect(mockPaymentService.getPayment).toHaveBeenCalledWith('pix-123');
          |                                             ^
      198 |     });
      199 |   });
      200 |

      at Object.toHaveBeenCalledWith (src/__tests__/integration/payment-flow.test.ts:197:45)

  ● Payment Flow Integration Tests › Crypto Payment Flow › should complete Bitcoin payment flow successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      225 |
      226 |       // Assert
    > 227 |       expect(result.success).toBe(true);
          |                              ^
      228 |       expect(result.cryptoPayment).toEqual(cryptoPaymentResponse);
      229 |       expect(mockOrderRepository.update).toHaveBeenCalledWith(
      230 |         expect.objectContaining({

      at Object.toBe (src/__tests__/integration/payment-flow.test.ts:227:30)

  ● Payment Flow Integration Tests › Crypto Payment Flow › should handle crypto exchange rate fluctuations

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 2
    Received number of calls: 0

      264 |       expect(result2.success).toBe(true);
      265 |       // The crypto amounts should be different due to rate change
    > 266 |       expect(mockCryptoPaymentService.getExchangeRate).toHaveBeenCalledTimes(2);
          |                                                        ^
      267 |     });
      268 |
      269 |     it('should handle USDT payment with stable rate', async () => {

      at Object.toHaveBeenCalledTimes (src/__tests__/integration/payment-flow.test.ts:266:56)

  ● Payment Flow Integration Tests › Crypto Payment Flow › should handle USDT payment with stable rate

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      292 |
      293 |       // Assert
    > 294 |       expect(result.success).toBe(true);
          |                              ^
      295 |       expect(result.cryptoPayment?.exchangeRate).toBe(1);
      296 |     });
      297 |   });

      at Object.toBe (src/__tests__/integration/payment-flow.test.ts:294:30)

  ● Payment Flow Integration Tests › MercadoPago Payment Flow › should create MercadoPago preference successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      320 |
      321 |       // Assert
    > 322 |       expect(result.success).toBe(true);
          |                              ^
      323 |       expect(result.preferenceId).toBe('pref-123');
      324 |       expect(result.checkoutUrl).toBe('https://mercadopago.com/checkout/pref-123');
      325 |       expect(mockPaymentService.createPreference).toHaveBeenCalledWith(

      at Object.toBe (src/__tests__/integration/payment-flow.test.ts:322:30)

  ● Payment Flow Integration Tests › MercadoPago Payment Flow › should handle MercadoPago API errors

    expect(received).toContain(expected) // indexOf

    Expected substring: "MercadoPago"
    Received string:    "Climbing date must be in the future"

      361 |       // Assert
      362 |       expect(result.success).toBe(false);
    > 363 |       expect(result.error).toContain('MercadoPago');
          |                            ^
      364 |     });
      365 |   });
      366 |

      at Object.toContain (src/__tests__/integration/payment-flow.test.ts:363:28)

  ● Payment Flow Integration Tests › WhatsApp Payment Flow › should generate WhatsApp payment URL correctly

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      380 |
      381 |       // Assert
    > 382 |       expect(result.success).toBe(true);
          |                              ^
      383 |       expect(result.whatsappUrl).toBeDefined();
      384 |       expect(result.whatsappUrl).toContain('https://api.whatsapp.com/send');
      385 |       expect(result.whatsappUrl).toContain('phone=');

      at Object.toBe (src/__tests__/integration/payment-flow.test.ts:382:30)

  ● Payment Flow Integration Tests › WhatsApp Payment Flow › should include complete order details in WhatsApp message

    expect(received).toBeDefined()

    Received: undefined

      401 |
      402 |       // Assert
    > 403 |       expect(result.whatsappUrl).toBeDefined();
          |                                  ^
      404 |
      405 |       const decodedMessage = decodeURIComponent(result.whatsappUrl!.split('text=')[1]);
      406 |       expect(decodedMessage).toContain('NOVA RESERVA');

      at Object.toBeDefined (src/__tests__/integration/payment-flow.test.ts:403:34)

  ● Payment Flow Integration Tests › Coupon Integration › should apply discount coupon correctly

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      452 |
      453 |       // Assert
    > 454 |       expect(result.success).toBe(true);
          |                              ^
      455 |       expect(mockOrderRepository.create).toHaveBeenCalledWith(
      456 |         expect.objectContaining({
      457 |           subtotal: { amount: 40000, currency: 'BRL' }, // R$ 400.00

      at Object.toBe (src/__tests__/integration/payment-flow.test.ts:454:30)

  ● Payment Flow Integration Tests › Coupon Integration › should handle invalid coupon gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      497 |
      498 |       // Assert
    > 499 |       expect(result.success).toBe(true);
          |                              ^
      500 |       expect(mockOrderRepository.create).toHaveBeenCalledWith(
      501 |         expect.objectContaining({
      502 |           subtotal: { amount: 40000, currency: 'BRL' },

      at Object.toBe (src/__tests__/integration/payment-flow.test.ts:499:30)

  ● Payment Flow Integration Tests › Order Validation › should validate participant details completeness

    expect(received).toContain(expected) // indexOf

    Expected substring: "Complete participant details required"
    Received string:    "Climbing date must be in the future"

      551 |       // Assert
      552 |       expect(result.success).toBe(false);
    > 553 |       expect(result.error).toContain('Complete participant details required');
          |                            ^
      554 |     });
      555 |
      556 |     it('should validate climbing date is in the future', async () => {

      at Object.toContain (src/__tests__/integration/payment-flow.test.ts:553:28)

  ● Payment Flow Integration Tests › Error Recovery and Resilience › should handle partial payment service failures

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      605 |       // Act - Second attempt should succeed
      606 |       const result2 = await createOrderUseCase.execute(orderRequest);
    > 607 |       expect(result2.success).toBe(true);
          |                               ^
      608 |     });
      609 |
      610 |     it('should handle database transaction rollback on payment failure', async () => {

      at Object.toBe (src/__tests__/integration/payment-flow.test.ts:607:31)

FAIL src/__tests__/integration/api-packages.test.ts
  ● Packages API Integration Tests › GET /api/packages › should return all active packages successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:124:23)

  ● Packages API Integration Tests › GET /api/packages › should return empty array when no packages exist

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:152:23)

  ● Packages API Integration Tests › GET /api/packages › should handle database errors gracefully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:168:23)

  ● Packages API Integration Tests › GET /api/packages › should include all required package fields

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:184:23)

  ● Packages API Integration Tests › GET /api/packages › should handle packages with missing optional fields

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:215:23)

  ● Packages API Integration Tests › GET /api/packages › should return packages in correct format for frontend consumption

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:232:23)

  ● Packages API Integration Tests › GET /api/packages › should handle concurrent requests correctly

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:263:24)

  ● Packages API Integration Tests › GET /api/packages › should handle large datasets efficiently

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:293:23)

  ● Packages API Integration Tests › GET /api/packages › should properly serialize dates and complex objects

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:311:23)

  ● Packages API Integration Tests › GET /api/packages › should handle repository timeout gracefully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:335:23)

  ● Packages API Integration Tests › GET /api/packages › should validate response schema

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:351:23)

  ● Packages API Integration Tests › Error Handling and Edge Cases › should handle malformed data from repository

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:383:23)

  ● Packages API Integration Tests › Error Handling and Edge Cases › should handle repository returning non-array data

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:395:23)

  ● Packages API Integration Tests › Error Handling and Edge Cases › should handle memory pressure with large responses

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:416:23)

  ● Packages API Integration Tests › Performance and Caching › should complete requests within acceptable time limits

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at Object.<anonymous> (src/__tests__/integration/api-packages.test.ts:429:23)

  ● Packages API Integration Tests › Performance and Caching › should handle multiple concurrent requests without degradation

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

       7 | global.Request = class Request {
       8 |   constructor(input, init) {
    >  9 |     this.url = input;
         |             ^
      10 |     this.method = init?.method || 'GET';
      11 |     this.headers = new Map(Object.entries(init?.headers || {}));
      12 |     this.body = init?.body;

      at new Request (jest.setup.js:9:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:26:10)
      at src/__tests__/integration/api-packages.test.ts:447:9
          at Function.from (<anonymous>)
      at Object.from (src/__tests__/integration/api-packages.test.ts:446:30)

FAIL src/components/cart/__tests__/CartModal.test.tsx
  ● CartModal Component › authentication and checkout › should show checkout form when user is authenticated and clicks checkout

    TestingLibraryElementError: Unable to find an element by: [data-testid="checkout-form"]

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"fixed inset-0 z-50 overflow-hidden"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"absolute inset-0 bg-black/50 backdrop-blur-sm"[39m
          [36m/>[39m
          [36m<div[39m
            [33mclass[39m=[32m"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex h-full flex-col"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between border-b border-neutral-200 p-4"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center space-x-2"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mdata-testid[39m=[32m"shopping-cart-icon"[39m
                  [36m>[39m
                    [0m🛒[0m
                  [36m</span>[39m
                  [36m<h2[39m
                    [33mclass[39m=[32m"text-lg font-semibold"[39m
                  [36m>[39m
                    [0mMeu Carrinho[0m
                  [36m</h2>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"text-sm text-neutral-500"[39m
                  [36m>[39m
                    [0m([0m
                    [0m1[0m
                    [0m [0m
                    [0mitem[0m
                    [0m)[0m
                  [36m</span>[39m
                [36m</div>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"rounded-full p-1 hover:bg-neutral-100 transition-colors"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mdata-testid[39m=[32m"close-icon"[39m
                  [36m>[39m
                    [0m×[0m
                  [36m</span>[39m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex-1 overflow-hidden"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex-1 overflow-y-auto p-4 space-y-4"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"p-4"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-start justify-between"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"flex-1"[39m
                      [36m>[39m
                        [36m<h3[39m
                          [33mclass[39m=[32m"font-medium text-neutral-900"[39m
                        [36m>[39m
                          [0mEscalada Iniciante[0m
                        [36m</h3>[39m
                        [36m<p[39m
                          [33mclass[39m=[32m"text-sm text-neutral-600 mt-1"[39m
                        [36m>[39m
                          [0mParticipante: [0m
                          [0mJoão Silva[0m
                        [36m</p>[39m
                        [36m<p[39m
                          [33mclass[39m=[32m"text-climb-600 font-semibold mt-2"[39m
                        [36m>[39m
                          [0mR$ 150.00[0m
                        [36m</p>[39m
                      [36m</div>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"flex items-center space-x-2 ml-4"[39m
                      [36m>[39m
                        [36m<button[39m
                          [33mclass[39m=[32m"rounded-full p-1 hover:bg-neutral-100 transition-colors"[39m
                          [33mdisabled[39m=[32m""[39m
                        [36m>[39m
                          [36m<span[39m
                            [33mdata-testid[39m=[32m"minus-icon"[39m
                          [36m>[39m
                            [0m-[0m
                          [36m</span>[39m
                        [36m</button>[39m
                        [36m<span[39m
                          [33mclass[39m=[32m"w-8 text-center font-medium"[39m
                        [36m>[39m
                          [0m1[0m
                        [36m</span>[39m
                        [36m<button[39m
                          [33mclass[39m=[32m"rounded-full p-1 hover:bg-neutral-100 transition-colors"[39m
                        [36m>[39m
                          [36m<span[39m
                            [33mdata-testid[39m=[32m"plus-icon"[39m
                          [36m>[39m
                            [0m+[0m
                          [36m</span>[39m
                        [36m</button>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<button[39m
                      [33mclass[39m=[32m"text-sm text-red-600 hover:text-red-700 mt-3 transition-colors"[39m
                    [36m>[39m
                      [0mRemover[0m
                    [36m</button>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"border-t border-neutral-200 p-4 space-y-4"[39m
                [36m>[39m
                  [36m<button[39m
                    [33mclass[39m=[32m"text-sm text-neutral-600 hover:text-neutral-700 transition-colors"[39m
                  [36m>[39m
                    [0mLimpar carrinho[0m
                  [36m</button>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center justify-between text-lg font-semibold"[39m
                  [36m>[39m
                    [36m<span>[39m
                      [0mTotal:[0m
                    [36m</span>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-climb-600"[39m
                    [36m>[39m
                      [0mR$ 0.00[0m
                    [36m</span>[39m
                  [36m</div>[39m
                  [36m<button[39m
                    [33mclass[39m=[32m"w-full"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mdata-testid[39m=[32m"credit-card-icon"[39m
                    [36m>[39m
                      [0m💳[0m
                    [36m</span>[39m
                    [0mEntrar e Comprar[0m
                  [36m</button>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      293 |       fireEvent.click(checkoutButton);
      294 |
    > 295 |       expect(screen.getByTestId('checkout-form')).toBeInTheDocument();
          |                     ^
      296 |       expect(screen.getByText('Finalizar Compra')).toBeInTheDocument(); // Header changes
      297 |     });
      298 |   });

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByTestId (src/components/cart/__tests__/CartModal.test.tsx:295:21)

FAIL src/infrastructure/services/__tests__/PaymentService.test.ts
  ● PaymentService › constructor › should warn when access token is missing

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "MERCADOPAGO_ACCESS_TOKEN not configured"

    Number of calls: 0

      57 |       new PaymentService();
      58 |
    > 59 |       expect(warnSpy).toHaveBeenCalledWith('MERCADOPAGO_ACCESS_TOKEN not configured');
         |                       ^
      60 |
      61 |       // Restore
      62 |       warnSpy.mockRestore();

      at Object.toHaveBeenCalledWith (src/infrastructure/services/__tests__/PaymentService.test.ts:59:23)

PASS src/components/sections/__tests__/PackagesSection.test.tsx
  ● Console

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.error
      Warning: An update to PackagesSection inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at useState (/app/src/components/sections/PackagesSection.tsx:47:47)

      65 |         if (result.success) {
      66 |           console.log('✅ Setando pacotes:', result.data.length, 'pacotes');
    > 67 |           setApiPackages(result.data);
         |           ^
      68 |         } else {
      69 |           console.error('❌ API retornou success: false');
      70 |         }

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setApiPackages (src/components/sections/PackagesSection.tsx:67:11)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.error
      Warning: An update to PackagesSection inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at useState (/app/src/components/sections/PackagesSection.tsx:47:47)

      74 |       } finally {
      75 |         console.log('🏁 Finalizando loading');
    > 76 |         setLoading(false);
         |         ^
      77 |       }
      78 |     };
      79 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setLoading (src/components/sections/PackagesSection.tsx:76:9)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      Button clicked for package: pkg-1

      at log (src/components/sections/PackagesSection.tsx:223:35)

    console.log
      Adding to cart: pkg-1

      at log (src/components/sections/PackagesSection.tsx:84:13)

    console.log
      Found package: {
        id: 'pkg-1',
        name: 'Escalada Iniciante',
        price: 150,
        originalPrice: 200,
        description: 'Perfeito para iniciantes',
        features: [ 'Instrução básica', 'Equipamentos inclusos' ],
        bonus: [ 'Lanche', 'Fotos' ],
        shape: 'circle',
        color: 'climb-500',
        duration: '4 horas',
        maxParticipants: 8,
        popular: false,
        disabled: false
      }

      at log (src/components/sections/PackagesSection.tsx:86:13)

    console.log
      Item added, opening cart...

      at log (src/components/sections/PackagesSection.tsx:96:15)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      Button clicked for package: pkg-1

      at log (src/components/sections/PackagesSection.tsx:223:35)

    console.log
      Adding to cart: pkg-1

      at log (src/components/sections/PackagesSection.tsx:84:13)

    console.log
      Found package: {
        id: 'pkg-1',
        name: 'Escalada Iniciante',
        price: 150,
        originalPrice: 200,
        description: 'Perfeito para iniciantes',
        features: [ 'Instrução básica', 'Equipamentos inclusos' ],
        bonus: [ 'Lanche', 'Fotos' ],
        shape: 'circle',
        color: 'climb-500',
        duration: '4 horas',
        maxParticipants: 8,
        popular: false,
        disabled: false
      }

      at log (src/components/sections/PackagesSection.tsx:86:13)

    console.log
      Item added, opening cart...

      at log (src/components/sections/PackagesSection.tsx:96:15)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      Button clicked for package: pkg-1

      at log (src/components/sections/PackagesSection.tsx:223:35)

    console.log
      Adding to cart: pkg-1

      at log (src/components/sections/PackagesSection.tsx:84:13)

    console.log
      Found package: {
        id: 'pkg-1',
        name: 'Escalada Iniciante',
        price: 150,
        originalPrice: 200,
        description: 'Perfeito para iniciantes',
        features: [ 'Instrução básica', 'Equipamentos inclusos' ],
        bonus: [ 'Lanche', 'Fotos' ],
        shape: 'circle',
        color: 'climb-500',
        duration: '4 horas',
        maxParticipants: 8,
        popular: false,
        disabled: false
      }

      at log (src/components/sections/PackagesSection.tsx:86:13)

    console.log
      Item added, opening cart...

      at log (src/components/sections/PackagesSection.tsx:96:15)

    console.log
      Button clicked for package: pkg-1

      at log (src/components/sections/PackagesSection.tsx:223:35)

    console.log
      Adding to cart: pkg-1

      at log (src/components/sections/PackagesSection.tsx:84:13)

    console.log
      Found package: {
        id: 'pkg-1',
        name: 'Escalada Iniciante',
        price: 150,
        originalPrice: 200,
        description: 'Perfeito para iniciantes',
        features: [ 'Instrução básica', 'Equipamentos inclusos' ],
        bonus: [ 'Lanche', 'Fotos' ],
        shape: 'circle',
        color: 'climb-500',
        duration: '4 horas',
        maxParticipants: 8,
        popular: false,
        disabled: false
      }

      at log (src/components/sections/PackagesSection.tsx:86:13)

    console.log
      Item added, opening cart...

      at log (src/components/sections/PackagesSection.tsx:96:15)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.error
      💥 Erro no fetch: Error: API Error
          at Object.<anonymous> (/app/src/components/sections/__tests__/PackagesSection.test.tsx:309:53)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      70 |         }
      71 |       } catch (error) {
    > 72 |         console.error('💥 Erro no fetch:', error);
         |                 ^
      73 |         // Let the error be visible - no masking with fallbacks
      74 |       } finally {
      75 |         console.log('🏁 Finalizando loading');

      at error (src/components/sections/PackagesSection.tsx:72:17)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: { success: false, data: [] }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.error
      ❌ API retornou success: false

      67 |           setApiPackages(result.data);
      68 |         } else {
    > 69 |           console.error('❌ API retornou success: false');
         |                   ^
      70 |         }
      71 |       } catch (error) {
      72 |         console.error('💥 Erro no fetch:', error);

      at error (src/components/sections/PackagesSection.tsx:69:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

    console.log
      🔍 useEffect executado - iniciando fetch dos pacotes

      at log (src/components/sections/PackagesSection.tsx:52:13)

    console.log
      📡 Iniciando fetch para /api/packages

      at log (src/components/sections/PackagesSection.tsx:56:17)

    console.log
      📨 Response recebida: undefined undefined

      at log (src/components/sections/PackagesSection.tsx:60:17)

    console.log
      📦 Dados recebidos: {
        success: true,
        data: [
          {
            id: 'pkg-1',
            name: 'Escalada Iniciante',
            price: 150,
            originalPrice: 200,
            description: 'Perfeito para iniciantes',
            features: [Array],
            bonus: [Array],
            shape: 'circle',
            color: 'climb-500',
            duration: '4 horas',
            maxParticipants: 8,
            popular: false,
            disabled: false
          },
          {
            id: 'pkg-2',
            name: 'Escalada Avançada',
            price: 250,
            description: 'Para escaladores experientes',
            features: [Array],
            bonus: [Array],
            shape: 'hexagon',
            color: 'orange-400',
            duration: '6 horas',
            maxParticipants: 6,
            popular: true,
            disabled: false
          },
          {
            id: 'pkg-3',
            name: 'Escalada Premium',
            price: 350,
            description: 'Experiência exclusiva',
            features: [Array],
            bonus: [Array],
            shape: 'triangle',
            color: 'purple-500',
            duration: '8 horas',
            maxParticipants: 4,
            popular: false,
            disabled: true
          }
        ]
      }

      at log (src/components/sections/PackagesSection.tsx:63:17)

    console.log
      ✅ Setando pacotes: 3 pacotes

      at log (src/components/sections/PackagesSection.tsx:66:19)

    console.log
      🏁 Finalizando loading

      at log (src/components/sections/PackagesSection.tsx:75:17)

FAIL src/hooks/__tests__/usePackages.test.ts
  ● Console

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      24 |
      25 |         const packagesData = await getAllPackagesUseCase.execute();
    > 26 |         setPackages(packagesData);
         |         ^
      27 |       } catch (err) {
      28 |         setError(err instanceof Error ? err.message : 'Failed to fetch packages');
      29 |         console.error('Error fetching packages:', err);

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setPackages (src/hooks/usePackages.ts:26:9)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      29 |         console.error('Error fetching packages:', err);
      30 |       } finally {
    > 31 |         setLoading(false);
         |         ^
      32 |       }
      33 |     };
      34 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setLoading (src/hooks/usePackages.ts:31:9)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      68 |     refetch: async () => {
      69 |       try {
    > 70 |         setLoading(true);
         |         ^
      71 |         const packagesData = await getAllPackagesUseCase.execute();
      72 |         setPackages(packagesData);
      73 |       } catch (err) {

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at Object.setLoading [as refetch] (src/hooks/usePackages.ts:70:9)
      at Object.refetch (src/hooks/__tests__/usePackages.test.ts:213:28)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      70 |         setLoading(true);
      71 |         const packagesData = await getAllPackagesUseCase.execute();
    > 72 |         setPackages(packagesData);
         |         ^
      73 |       } catch (err) {
      74 |         setError(err instanceof Error ? err.message : 'Failed to fetch packages');
      75 |       } finally {

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at Object.setPackages [as refetch] (src/hooks/usePackages.ts:72:9)
      at Object.<anonymous> (src/hooks/__tests__/usePackages.test.ts:213:7)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      74 |         setError(err instanceof Error ? err.message : 'Failed to fetch packages');
      75 |       } finally {
    > 76 |         setLoading(false);
         |         ^
      77 |       }
      78 |     }
      79 |   };

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at Object.setLoading [as refetch] (src/hooks/usePackages.ts:76:9)
      at Object.<anonymous> (src/hooks/__tests__/usePackages.test.ts:213:7)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      68 |     refetch: async () => {
      69 |       try {
    > 70 |         setLoading(true);
         |         ^
      71 |         const packagesData = await getAllPackagesUseCase.execute();
      72 |         setPackages(packagesData);
      73 |       } catch (err) {

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at Object.setLoading [as refetch] (src/hooks/usePackages.ts:70:9)
      at Object.refetch (src/hooks/__tests__/usePackages.test.ts:228:28)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      70 |         setLoading(true);
      71 |         const packagesData = await getAllPackagesUseCase.execute();
    > 72 |         setPackages(packagesData);
         |         ^
      73 |       } catch (err) {
      74 |         setError(err instanceof Error ? err.message : 'Failed to fetch packages');
      75 |       } finally {

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at Object.setPackages [as refetch] (src/hooks/usePackages.ts:72:9)
      at Object.<anonymous> (src/hooks/__tests__/usePackages.test.ts:228:7)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      74 |         setError(err instanceof Error ? err.message : 'Failed to fetch packages');
      75 |       } finally {
    > 76 |         setLoading(false);
         |         ^
      77 |       }
      78 |     }
      79 |   };

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at Object.setLoading [as refetch] (src/hooks/usePackages.ts:76:9)
      at Object.<anonymous> (src/hooks/__tests__/usePackages.test.ts:228:7)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      24 |
      25 |         const packagesData = await getAllPackagesUseCase.execute();
    > 26 |         setPackages(packagesData);
         |         ^
      27 |       } catch (err) {
      28 |         setError(err instanceof Error ? err.message : 'Failed to fetch packages');
      29 |         console.error('Error fetching packages:', err);

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setPackages (src/hooks/usePackages.ts:26:9)

    console.error
      Warning: An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

      29 |         console.error('Error fetching packages:', err);
      30 |       } finally {
    > 31 |         setLoading(false);
         |         ^
      32 |       }
      33 |     };
      34 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setLoading (src/hooks/usePackages.ts:31:9)

  ● usePackages Hook › successful package loading › should load packages successfully

    expect(received).toEqual(expected) // deep equality

    Expected: [{"createdAt": 2026-02-14T18:41:05.550Z, "description": "Perfect for beginners", "difficulty": "beginner", "duration": 4, "id": "basic-climbing", "images": ["climb1.jpg"], "includes": ["Equipment", "Guide", "Safety briefing"], "location": "Setor A", "maxParticipants": 8, "name": "Basic Climbing Experience", "price": 150, "requirements": ["Minimum age: 12"], "updatedAt": 2026-02-14T18:41:05.550Z}, {"createdAt": 2026-02-14T18:41:05.550Z, "description": "For experienced climbers", "difficulty": "advanced", "duration": 6, "id": "advanced-climbing", "images": ["climb2.jpg"], "includes": ["Advanced equipment", "Expert guide"], "location": "Setor B", "maxParticipants": 4, "name": "Advanced Rock Climbing", "price": 250, "requirements": ["Previous climbing experience required"], "updatedAt": 2026-02-14T18:41:05.550Z}]
    Received: undefined

       96 |       });
       97 |
    >  98 |       expect(result.current.packages).toEqual(mockPackages);
          |                                       ^
       99 |       expect(result.current.error).toBeNull();
      100 |       expect(mockGetAllPackages.execute).toHaveBeenCalledTimes(1);
      101 |     });

      at Object.toEqual (src/hooks/__tests__/usePackages.test.ts:98:39)

  ● usePackages Hook › successful package loading › should provide package utility functions

    TypeError: Cannot read properties of undefined (reading 'find')

      50 |
      51 |   const getPackageById = (id: string): Package | undefined => {
    > 52 |     return packages.find(pkg => pkg.id === id);
         |                     ^
      53 |   };
      54 |
      55 |   const getPackagesByType = (types: string[]): Package[] => {

      at Object.find [as getPackageById] (src/hooks/usePackages.ts:52:21)
      at Object.getPackageById (src/hooks/__tests__/usePackages.test.ts:111:43)

  ● usePackages Hook › error handling › should handle loading errors

    expect(received).toBe(expected) // Object.is equality

    Expected: "Failed to fetch packages"
    Received: null

      133 |       });
      134 |
    > 135 |       expect(result.current.error).toBe(errorMessage);
          |                                    ^
      136 |       expect(result.current.packages).toEqual([]);
      137 |     });
      138 |

      at Object.toBe (src/hooks/__tests__/usePackages.test.ts:135:36)

  ● usePackages Hook › error handling › should handle non-Error objects

    expect(received).toBe(expected) // Object.is equality

    Expected: "Failed to fetch packages"
    Received: null

      146 |       });
      147 |
    > 148 |       expect(result.current.error).toBe('Failed to fetch packages');
          |                                    ^
      149 |     });
      150 |   });
      151 |

      at Object.toBe (src/hooks/__tests__/usePackages.test.ts:148:36)

  ● usePackages Hook › availability checking › should check package availability successfully

    expect(received).toEqual(expected) // deep equality

    Expected: {"available": true, "restrictions": [], "spotsLeft": 5}
    Received: undefined

      160 |       const availability = await result.current.checkAvailability('basic-climbing');
      161 |
    > 162 |       expect(availability).toEqual({
          |                            ^
      163 |         available: true,
      164 |         spotsLeft: 5,
      165 |         restrictions: [],

      at Object.toEqual (src/hooks/__tests__/usePackages.test.ts:162:28)

  ● usePackages Hook › availability checking › should check availability with specific date

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "basic-climbing", 2024-12-25T00:00:00.000Z

    Number of calls: 0

      178 |       await result.current.checkAvailability('basic-climbing', testDate);
      179 |
    > 180 |       expect(mockGetPackageAvailability.execute).toHaveBeenCalledWith('basic-climbing', testDate);
          |                                                  ^
      181 |     });
      182 |
      183 |     it('should handle availability check errors', async () => {

      at Object.toHaveBeenCalledWith (src/hooks/__tests__/usePackages.test.ts:180:50)

  ● usePackages Hook › availability checking › should handle availability check errors

    expect(received).toEqual(expected) // deep equality

    Expected: {"available": false, "restrictions": ["Erro ao verificar disponibilidade"], "spotsLeft": 0}
    Received: undefined

      192 |       const availability = await result.current.checkAvailability('basic-climbing');
      193 |
    > 194 |       expect(availability).toEqual({
          |                            ^
      195 |         available: false,
      196 |         spotsLeft: 0,
      197 |         restrictions: ['Erro ao verificar disponibilidade'],

      at Object.toEqual (src/hooks/__tests__/usePackages.test.ts:194:28)

  ● usePackages Hook › refetch functionality › should refetch packages successfully

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 1
    Received number of calls: 0

      213 |       await result.current.refetch();
      214 |
    > 215 |       expect(mockGetAllPackages.execute).toHaveBeenCalledTimes(1);
          |                                          ^
      216 |     });
      217 |
      218 |     it('should handle refetch errors', async () => {

      at Object.toHaveBeenCalledTimes (src/hooks/__tests__/usePackages.test.ts:215:42)

  ● usePackages Hook › refetch functionality › should handle refetch errors

    expect(received).toBe(expected) // Object.is equality

    Expected: "Refetch error"
    Received: null

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      229 |
      230 |       await waitFor(() => {
    > 231 |         expect(result.current.error).toBe('Refetch error');
          |                                      ^
      232 |         expect(result.current.loading).toBe(false);
      233 |       });
      234 |     });

      at toBe (src/hooks/__tests__/usePackages.test.ts:231:38)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● usePackages Hook › package filtering and searching › should filter packages by multiple types

    TypeError: Cannot read properties of undefined (reading 'filter')

      54 |
      55 |   const getPackagesByType = (types: string[]): Package[] => {
    > 56 |     return packages.filter(pkg => types.includes(pkg.id));
         |                     ^
      57 |   };
      58 |
      59 |   return {

      at Object.filter [as getPackagesByType] (src/hooks/usePackages.ts:56:21)
      at Object.getPackagesByType (src/hooks/__tests__/usePackages.test.ts:245:47)

  ● usePackages Hook › package filtering and searching › should return empty array for non-matching types

    TypeError: Cannot read properties of undefined (reading 'filter')

      54 |
      55 |   const getPackagesByType = (types: string[]): Package[] => {
    > 56 |     return packages.filter(pkg => types.includes(pkg.id));
         |                     ^
      57 |   };
      58 |
      59 |   return {

      at Object.filter [as getPackagesByType] (src/hooks/usePackages.ts:56:21)
      at Object.getPackagesByType (src/hooks/__tests__/usePackages.test.ts:256:47)

PASS src/components/cart/__tests__/CartButton.test.tsx
PASS src/components/auth/__tests__/AuthGuard.test.tsx
PASS src/hooks/__tests__/useAuth.test.ts
  ● Console

    console.warn
      Failed to read user preferences from localStorage: Error: localStorage error
          at Object.<anonymous> (/app/src/hooks/__tests__/useAuth.test.ts:194:15)
          at /app/node_modules/jest-mock/build/index.js:397:39
          at Object.<anonymous> (/app/node_modules/jest-mock/build/index.js:404:13)
          at Object.mockConstructor [as getItem] (/app/node_modules/jest-mock/build/index.js:148:19)
          at getItem (/app/src/hooks/useAuth.ts:18:24)
          at mountMemo (/app/node_modules/react-dom/cjs/react-dom.development.js:16406:19)
          at Object.useMemo (/app/node_modules/react-dom/cjs/react-dom.development.js:16851:16)
          at useMemo (/app/node_modules/react/cjs/react.development.js:1650:21)
          at useAuth (/app/src/hooks/useAuth.ts:11:42)
          at /app/src/hooks/__tests__/useAuth.test.ts:197:50
          at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:331:27)
          at renderWithHooks (/app/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
          at mountIndeterminateComponent (/app/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
          at beginWork (/app/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
          at beginWork$1 (/app/node_modules/react-dom/cjs/react-dom.development.js:27465:14)
          at performUnitOfWork (/app/node_modules/react-dom/cjs/react-dom.development.js:26599:12)
          at workLoopSync (/app/node_modules/react-dom/cjs/react-dom.development.js:26505:5)
          at renderRootSync (/app/node_modules/react-dom/cjs/react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (/app/node_modules/react-dom/cjs/react-dom.development.js:25777:74)
          at flushActQueue (/app/node_modules/react/cjs/react.development.js:2667:24)
          at act (/app/node_modules/react/cjs/react.development.js:2582:11)
          at /app/node_modules/@testing-library/react/dist/act-compat.js:47:25
          at renderRoot (/app/node_modules/@testing-library/react/dist/pure.js:190:26)
          at render (/app/node_modules/@testing-library/react/dist/pure.js:292:10)
          at renderHook (/app/node_modules/@testing-library/react/dist/pure.js:340:7)
          at Object.<anonymous> (/app/src/hooks/__tests__/useAuth.test.ts:197:36)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      135 |       return;
      136 |     }
    > 137 |     originalWarn.call(console, ...args);
          |                  ^
      138 |   };
      139 | });
      140 |

      at console.call (jest.setup.js:137:18)
      at warn (src/hooks/useAuth.ts:21:15)
      at mountMemo (node_modules/react-dom/cjs/react-dom.development.js:16406:19)
      at Object.useMemo (node_modules/react-dom/cjs/react-dom.development.js:16851:16)
      at useMemo (node_modules/react/cjs/react.development.js:1650:21)
      at useAuth (src/hooks/useAuth.ts:11:42)
      at src/hooks/__tests__/useAuth.test.ts:197:50
      at TestComponent (node_modules/@testing-library/react/dist/pure.js:331:27)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderHook (node_modules/@testing-library/react/dist/pure.js:340:7)
      at Object.<anonymous> (src/hooks/__tests__/useAuth.test.ts:197:36)

PASS src/components/auth/__tests__/LoginButton.test.tsx
PASS src/components/cart/__tests__/index.test.ts
PASS src/store/__tests__/useCartStore.test.ts
PASS src/infrastructure/services/__tests__/TourService.test.ts
PASS src/lib/__tests__/utils.test.ts
PASS src/core/use-cases/__tests__/GetAllPackages.test.ts
PASS src/infrastructure/services/__tests__/AuthService.test.ts
  ● Console

    console.error
      Error during logout: Error: AuthService.logout should be called through Privy hooks in React components
          at AuthService.logout (/app/src/infrastructure/services/AuthService.ts:23:13)
          at Object.logout (/app/src/infrastructure/services/__tests__/AuthService.test.ts:54:32)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      23 |       throw new Error('AuthService.logout should be called through Privy hooks in React components');
      24 |     } catch (error) {
    > 25 |       console.error('Error during logout:', error);
         |               ^
      26 |       throw error;
      27 |     }
      28 |   }

      at AuthService.error [as logout] (src/infrastructure/services/AuthService.ts:25:15)
      at Object.logout (src/infrastructure/services/__tests__/AuthService.test.ts:54:32)

    console.error
      Error during logout: Error: AuthService.logout should be called through Privy hooks in React components
          at AuthService.logout (/app/src/infrastructure/services/AuthService.ts:23:13)
          at Object.logout (/app/src/infrastructure/services/__tests__/AuthService.test.ts:77:32)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      23 |       throw new Error('AuthService.logout should be called through Privy hooks in React components');
      24 |     } catch (error) {
    > 25 |       console.error('Error during logout:', error);
         |               ^
      26 |       throw error;
      27 |     }
      28 |   }

      at AuthService.error [as logout] (src/infrastructure/services/AuthService.ts:25:15)
      at Object.logout (src/infrastructure/services/__tests__/AuthService.test.ts:77:32)

    console.error
      Error during logout: Error: AuthService.logout should be called through Privy hooks in React components
          at AuthService.logout (/app/src/infrastructure/services/AuthService.ts:23:13)
          at Object.logout (/app/src/infrastructure/services/__tests__/AuthService.test.ts:211:27)
          at Promise.then.completed (/app/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/app/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/app/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/app/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/app/node_modules/jest-circus/build/run.js:121:9)
          at run (/app/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/app/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
          at runTestInternal (/app/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/app/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/app/node_modules/jest-runner/build/testWorker.js:106:12)

      23 |       throw new Error('AuthService.logout should be called through Privy hooks in React components');
      24 |     } catch (error) {
    > 25 |       console.error('Error during logout:', error);
         |               ^
      26 |       throw error;
      27 |     }
      28 |   }

      at AuthService.error [as logout] (src/infrastructure/services/AuthService.ts:25:15)
      at Object.logout (src/infrastructure/services/__tests__/AuthService.test.ts:211:27)

PASS src/core/use-cases/__tests__/LoginUser.test.ts
PASS src/app/api/packages/__tests__/route.test.ts
PASS src/__tests__/theme-query-params.test.ts
PASS src/components/cart/__tests__/CheckoutForm.test.tsx
  ● Console

    console.warn
      NEXT_PUBLIC_MERCADOPAGO_PUBLIC_KEY not configured

      135 |       return;
      136 |     }
    > 137 |     originalWarn.call(console, ...args);
          |                  ^
      138 |   };
      139 | });
      140 |

      at console.call (jest.setup.js:137:18)
      at new warn (src/infrastructure/services/PaymentService.ts:19:15)
      at new OrderRepository (src/infrastructure/repositories/OrderRepository.ts:12:27)
      at handleSubmit (src/components/cart/CheckoutForm.tsx:114:31)
      at HTMLUnknownElement.callCallback (node_modules/react-dom/cjs/react-dom.development.js:4164:14)
      at HTMLUnknownElement.callTheUserObjectsOperation (node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at invokeGuardedCallbackAndCatchFirstError (node_modules/react-dom/cjs/react-dom.development.js:4291:25)
      at executeDispatch (node_modules/react-dom/cjs/react-dom.development.js:9041:3)
      at processDispatchQueueItemsInOrder (node_modules/react-dom/cjs/react-dom.development.js:9073:7)
      at processDispatchQueue (node_modules/react-dom/cjs/react-dom.development.js:9086:5)
      at dispatchEventsForPlugins (node_modules/react-dom/cjs/react-dom.development.js:9097:3)
      at node_modules/react-dom/cjs/react-dom.development.js:9288:12
      at batchedUpdates$1 (node_modules/react-dom/cjs/react-dom.development.js:26179:12)
      at batchedUpdates (node_modules/react-dom/cjs/react-dom.development.js:3991:12)
      at dispatchEventForPluginEventSystem (node_modules/react-dom/cjs/react-dom.development.js:9287:3)
      at dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay (node_modules/react-dom/cjs/react-dom.development.js:6465:5)
      at dispatchEvent (node_modules/react-dom/cjs/react-dom.development.js:6457:5)
      at dispatchDiscreteEvent (node_modules/react-dom/cjs/react-dom.development.js:6430:5)
      at HTMLDivElement.callTheUserObjectsOperation (node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLButtonElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLButtonElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLButtonElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at node_modules/@testing-library/dom/dist/events.js:19:20
      at node_modules/@testing-library/react/dist/pure.js:108:16
      at node_modules/@testing-library/react/dist/act-compat.js:48:24
      at act (node_modules/react/cjs/react.development.js:2512:16)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at Object.eventWrapper (node_modules/@testing-library/react/dist/pure.js:107:28)
      at fireEvent (node_modules/@testing-library/dom/dist/events.js:12:35)
      at Function.fireEvent.<computed> [as click] (node_modules/@testing-library/dom/dist/events.js:110:36)
      at Function.fireEvent.<computed> [as click] (node_modules/@testing-library/react/dist/fire-event.js:15:52)
      at Object.click (src/components/cart/__tests__/CheckoutForm.test.tsx:325:17)

    console.log
      Payment Event: {
        type: 'payment_attempt',
        orderId: 'vy81flvqjinmlmnx2x3',
        amount: 15000,
        currency: 'BRL',
        status: 'initiated',
        provider: 'mercadopago',
        metadata: { items: [ [Object] ] },
        timestamp: '2026-02-14T18:41:09.640Z'
      }

      at PaymentMonitor.log [as logEvent] (src/lib/payment-monitor.ts:200:13)

    console.error
      Error creating Mercado Pago preference: Error: MercadoPago access token not configured
          at PaymentService.callMercadoPagoAPI (/app/src/infrastructure/services/PaymentService.ts:195:13)
          at PaymentService.callMercadoPagoAPI [as createPreference] (/app/src/infrastructure/services/PaymentService.ts:61:35)
          at OrderRepository.createPreference [as create] (/app/src/infrastructure/repositories/OrderRepository.ts:41:52)
          at CreateOrder.create [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:120:34)
          at execute (/app/src/components/cart/CheckoutForm.tsx:117:47)
          at HTMLUnknownElement.callCallback (/app/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
          at HTMLUnknownElement.callTheUserObjectsOperation (/app/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
          at innerInvokeEventListeners (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
          at invokeEventListeners (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (/app/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (/app/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
          at invokeGuardedCallback (/app/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
          at invokeGuardedCallbackAndCatchFirstError (/app/node_modules/react-dom/cjs/react-dom.development.js:4291:25)
          at executeDispatch (/app/node_modules/react-dom/cjs/react-dom.development.js:9041:3)
          at processDispatchQueueItemsInOrder (/app/node_modules/react-dom/cjs/react-dom.development.js:9073:7)
          at processDispatchQueue (/app/node_modules/react-dom/cjs/react-dom.development.js:9086:5)
          at dispatchEventsForPlugins (/app/node_modules/react-dom/cjs/react-dom.development.js:9097:3)
          at /app/node_modules/react-dom/cjs/react-dom.development.js:9288:12
          at batchedUpdates$1 (/app/node_modules/react-dom/cjs/react-dom.development.js:26179:12)
          at batchedUpdates (/app/node_modules/react-dom/cjs/react-dom.development.js:3991:12)
          at dispatchEventForPluginEventSystem (/app/node_modules/react-dom/cjs/react-dom.development.js:9287:3)
          at dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay (/app/node_modules/react-dom/cjs/react-dom.development.js:6465:5)
          at dispatchEvent (/app/node_modules/react-dom/cjs/react-dom.development.js:6457:5)
          at dispatchDiscreteEvent (/app/node_modules/react-dom/cjs/react-dom.development.js:6430:5)
          at HTMLDivElement.callTheUserObjectsOperation (/app/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
          at innerInvokeEventListeners (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
          at invokeEventListeners (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
          at HTMLButtonElementImpl._dispatch (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
          at HTMLButtonElementImpl.dispatchEvent (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
          at HTMLButtonElement.dispatchEvent (/app/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
          at /app/node_modules/@testing-library/dom/dist/events.js:19:20
          at /app/node_modules/@testing-library/react/dist/pure.js:108:16
          at /app/node_modules/@testing-library/react/dist/act-compat.js:48:24
          at act (/app/node_modules/react/cjs/react.development.js:2512:16)
          at /app/node_modules/@testing-library/react/dist/act-compat.js:47:25
          at Object.eventWrapper (/app/node_modules/@testing-library/react/dist/pure.js:107:28)
          at fireEvent (/app/node_modules/@testing-library/dom/dist/events.js:12:35)
          at Function.fireEvent.<computed> [as click] (/app/node_modules/@testing-library/dom/dist/events.js:110:36)
          at Function.fireEvent.<computed> [as click] (/app/node_modules/@testing-library/react/dist/fire-event.js:15:52)
          at Object.click (/app/src/components/cart/__tests__/CheckoutForm.test.tsx:325:17)

      67 |       };
      68 |     } catch (error) {
    > 69 |       console.error('Error creating Mercado Pago preference:', error);
         |               ^
      70 |       this.monitor.trackPaymentError(request.orderId, 'mercadopago', error as Error);
      71 |       throw new Error('Failed to create payment preference');
      72 |     }

      at PaymentService.error [as createPreference] (src/infrastructure/services/PaymentService.ts:69:15)
      at OrderRepository.create (src/infrastructure/repositories/OrderRepository.ts:41:26)
      at CreateOrder.execute (src/core/use-cases/orders/CreateOrder.ts:120:7)
      at handleSubmit (src/components/cart/CheckoutForm.tsx:117:22)

    console.log
      Payment Event: {
        type: 'payment_error',
        orderId: 'vy81flvqjinmlmnx2x3',
        status: 'error',
        provider: 'mercadopago',
        metadata: {
          error: {
            message: 'MercadoPago access token not configured',
            stack: 'Error: MercadoPago access token not configured\n' +
              '    at PaymentService.callMercadoPagoAPI (/app/src/infrastructure/services/PaymentService.ts:195:13)\n' +
              '    at PaymentService.callMercadoPagoAPI [as createPreference] (/app/src/infrastructure/services/PaymentService.ts:61:35)\n' +
              '    at OrderRepository.createPreference [as create] (/app/src/infrastructure/repositories/OrderRepository.ts:41:52)\n' +
              '    at CreateOrder.create [as execute] (/app/src/core/use-cases/orders/CreateOrder.ts:120:34)\n' +
              '    at execute (/app/src/components/cart/CheckoutForm.tsx:117:47)\n' +
              '    at HTMLUnknownElement.callCallback (/app/node_modules/react-dom/cjs/react-dom.development.js:4164:14)\n' +
              '    at HTMLUnknownElement.callTheUserObjectsOperation (/app/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)\n' +
              '    at innerInvokeEventListeners (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)\n' +
              '    at invokeEventListeners (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)\n' +
              '    at HTMLUnknownElementImpl._dispatch (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)\n' +
              '    at HTMLUnknownElementImpl.dispatchEvent (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)\n' +
              '    at HTMLUnknownElement.dispatchEvent (/app/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)\n' +
              '    at Object.invokeGuardedCallbackDev (/app/node_modules/react-dom/cjs/react-dom.development.js:4213:16)\n' +
              '    at invokeGuardedCallback (/app/node_modules/react-dom/cjs/react-dom.development.js:4277:31)\n' +
              '    at invokeGuardedCallbackAndCatchFirstError (/app/node_modules/react-dom/cjs/react-dom.development.js:4291:25)\n' +
              '    at executeDispatch (/app/node_modules/react-dom/cjs/react-dom.development.js:9041:3)\n' +
              '    at processDispatchQueueItemsInOrder (/app/node_modules/react-dom/cjs/react-dom.development.js:9073:7)\n' +
              '    at processDispatchQueue (/app/node_modules/react-dom/cjs/react-dom.development.js:9086:5)\n' +
              '    at dispatchEventsForPlugins (/app/node_modules/react-dom/cjs/react-dom.development.js:9097:3)\n' +
              '    at /app/node_modules/react-dom/cjs/react-dom.development.js:9288:12\n' +
              '    at batchedUpdates$1 (/app/node_modules/react-dom/cjs/react-dom.development.js:26179:12)\n' +
              '    at batchedUpdates (/app/node_modules/react-dom/cjs/react-dom.development.js:3991:12)\n' +
              '    at dispatchEventForPluginEventSystem (/app/node_modules/react-dom/cjs/react-dom.development.js:9287:3)\n' +
              '    at dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay (/app/node_modules/react-dom/cjs/react-dom.development.js:6465:5)\n' +
              '    at dispatchEvent (/app/node_modules/react-dom/cjs/react-dom.development.js:6457:5)\n' +
              '    at dispatchDiscreteEvent (/app/node_modules/react-dom/cjs/react-dom.development.js:6430:5)\n' +
              '    at HTMLDivElement.callTheUserObjectsOperation (/app/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)\n' +
              '    at innerInvokeEventListeners (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)\n' +
              '    at invokeEventListeners (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)\n' +
              '    at HTMLButtonElementImpl._dispatch (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)\n' +
              '    at HTMLButtonElementImpl.dispatchEvent (/app/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)\n' +
              '    at HTMLButtonElement.dispatchEvent (/app/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)\n' +
              '    at /app/node_modules/@testing-library/dom/dist/events.js:19:20\n' +
              '    at /app/node_modules/@testing-library/react/dist/pure.js:108:16\n' +
              '    at /app/node_modules/@testing-library/react/dist/act-compat.js:48:24\n' +
              '    at act (/app/node_modules/react/cjs/react.development.js:2512:16)\n' +
              '    at /app/node_modules/@testing-library/react/dist/act-compat.js:47:25\n' +
              '    at Object.eventWrapper (/app/node_modules/@testing-library/react/dist/pure.js:107:28)\n' +
              '    at fireEvent (/app/node_modules/@testing-library/dom/dist/events.js:12:35)\n' +
              '    at Function.fireEvent.<computed> [as click] (/app/node_modules/@testing-library/dom/dist/events.js:110:36)\n' +
              '    at Function.fireEvent.<computed> [as click] (/app/node_modules/@testing-library/react/dist/fire-event.js:15:52)\n' +
              '    at Object.click (/app/src/components/cart/__tests__/CheckoutForm.test.tsx:325:17)'
          }
        },
        timestamp: '2026-02-14T18:41:09.674Z'
      }

      at PaymentMonitor.log [as logEvent] (src/lib/payment-monitor.ts:200:13)

    console.error
      Error creating order: Error: Failed to create payment preference
          at PaymentService.createPreference (/app/src/infrastructure/services/PaymentService.ts:71:13)
          at OrderRepository.create (/app/src/infrastructure/repositories/OrderRepository.ts:41:26)
          at CreateOrder.execute (/app/src/core/use-cases/orders/CreateOrder.ts:120:7)
          at handleSubmit (/app/src/components/cart/CheckoutForm.tsx:117:22)

      46 |       return preference.id;
      47 |     } catch (error) {
    > 48 |       console.error('Error creating order:', error);
         |               ^
      49 |       throw new Error('Failed to create order');
      50 |     }
      51 |   }

      at OrderRepository.error [as create] (src/infrastructure/repositories/OrderRepository.ts:48:15)
      at CreateOrder.execute (src/core/use-cases/orders/CreateOrder.ts:120:7)
      at handleSubmit (src/components/cart/CheckoutForm.tsx:117:22)

    console.error
      Error creating order: Error: Failed to create order
          at OrderRepository.create (/app/src/infrastructure/repositories/OrderRepository.ts:49:13)
          at CreateOrder.execute (/app/src/core/use-cases/orders/CreateOrder.ts:120:7)
          at handleSubmit (/app/src/components/cart/CheckoutForm.tsx:117:22)

      124 |
      125 |     } catch (error) {
    > 126 |       console.error('Error creating order:', error);
          |               ^
      127 |       return {
      128 |         success: false,
      129 |         error: error instanceof Error ? error.message : 'Failed to create order',

      at CreateOrder.error [as execute] (src/core/use-cases/orders/CreateOrder.ts:126:15)
      at handleSubmit (src/components/cart/CheckoutForm.tsx:117:22)

    console.error
      Warning: An update to CheckoutForm inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at cartItems (/app/src/components/cart/CheckoutForm.tsx:25:32)

      147 |       alert('Erro ao processar pedido. Tente novamente.');
      148 |     } finally {
    > 149 |       setIsSubmitting(false);
          |       ^
      150 |     }
      151 |   };
      152 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at setIsSubmitting (src/components/cart/CheckoutForm.tsx:149:7)


Test Suites: 5 failed, 15 passed, 20 total
Tests:       43 failed, 1 skipped, 351 passed, 395 total
Snapshots:   0 total
Time:        6.059 s
Ran all test suites.
